Handoff Artifacts for Planner & Architect GPTs
=============================================

This folder contains the machine-readable handoff packets generated by the Requirements Engineer.
They mirror the human-readable packet in `requirements-to-planner-architect.md`.

Files
-----

- `requirements-to-planner-architect.yaml` - YAML representation of the handoff packet.
- `requirements-to-planner-architect.json` - JSON representation of the same packet.
- `requirements-to-planner-architect.md` - Canonical human-readable document (full contract snapshot).
- `requirements-to-planner-architect.schema.json` - JSON Schema for validating the machine-readable handoff packet.
- `requirements-to-planner-architect.example.json` - Minimal golden example that validates against the schema.
- `requirements-to-planner-architect.example.yaml` - YAML twin of the golden example.

How to use
----------

1. Syntax validation
   - JSON: `jq . handoff/requirements-to-planner-architect.json`
   - YAML: `yq eval . handoff/requirements-to-planner-architect.yaml`

2. Schema validation (AJV)
   - `ajv validate -s handoff/requirements-to-planner-architect.schema.json -d handoff/requirements-to-planner-architect.example.json`
   - For YAML: `yq -o=json handoff/requirements-to-planner-architect.example.yaml | ajv validate -s handoff/requirements-to-planner-architect.schema.json -d -`

3. Planner/Architect GPT ingestion
   - Read the YAML or JSON file from the repository root path `handoff/requirements-to-planner-architect.(yaml|json)`.
   - Expect top-level fields: `id`, `title`, `summary`, `requirements`, `acceptance_criteria`, `provenance`, `contacts`.

4. Mirror / CI tokens

- To enable CI to ingest validated handoffs into the Assistants/API mirror, set the repository secret `MIRROR_TOKEN` to match the mirror server's `MIRROR_BEARER_TOKEN` environment variable.

- Add it in GitHub: Settings → Secrets and variables → Actions → New repository secret (Name: `MIRROR_TOKEN`).

- Example local test:

```powershell
$env:MIRROR_BEARER_TOKEN = '<paste_token>'
python -m mirror.main
# in another terminal
curl -X POST http://localhost:8080/ingest_handoff -H "Authorization: Bearer <paste_token>" -H "Content-Type: application/json" -d @handoff/requirements-to-planner-architect.example.json
```

Update process
--------------

Always update the `.md` and regenerate the `.yaml`/`.json` in the same commit to keep them in sync.

Agent handoffs
--------------

The repository also contains AI assistant handoff artifacts that document automated changes and
agent-visible entry points. Recent agent handoffs include:

- `railweb_agent_handoff_v20250919.yaml` / `railweb_agent_handoff_v20250919.md`
- `railweb_agent_handoff_v20250920.yaml` / `railweb_agent_handoff_v20250920.md`  (notes updates on orchestrator and Notion materializer)

When switching threads or accepting an automated change, review these handoff packets for
entry points, required env vars, and operational notes.
